\chapter{@Microserviços}

%Microserviços tem MUITO assunto, aqui vc pode escrever muita coisa,
%gerar muitos tópicos... com certeza escreveremos muito aqui
%
%pode começar por isso:
%
%\url{https://www.thoughtworks.com/pt/insights/blog/microservices-nutshell}



Com microserviços é possível escalar apenas algumas partes do sistema, diminuindo
o custo e esforço para aumentar o poder de processamento para atender muitas requisições.

Pode haver um serviço que cuida do contexto do usuário; outro serviço que lida com a
lista de eventos disponíveis; outro serviço responsável por realizar reserva de vaga de
cada evento; e assim por diante. Ou seja, cada um desses serviços pode ter a sua a quantidade
de requisições diferentes umas das outras, mas os serviços poderão ser escalados de forma
independente e conforme a necessidade.

Um exemplo real pode ser objservado em um e-commerce.

\begin{citacao}

Ao criarmos a Editora Casa do Código, decidimos seguir outro caminho para o e-commerce.
Lá não podemos correr o risco de ficar com a loja fora do ar caso alguma funcionalidade
periférica falhe, então quebramos nossa arquitetura em serviços menores. Dessa forma, há
um sistema principal, que é a loja e está hospedada no Shopify, e vários outros sistemas
que gravitam em torno dela. Temos uma aplicação que faz a liberação dos e-books para os
clientes, outro que contabiliza os royalties para autores, outro para cuidar da logística
de envio dos livros impressos para o cliente, um painel de visualização dos livros comprados,
um para fazer a liberação de vale presentes e outro para promoções.

Dessa forma, quando um evento acontece na nossa loja online, os diferentes sistemas precisam
ser notificados. Para essas notificações usamos requisições HTTP, assim, quando uma compra
é confirmada na loja online, todos os sistemas recebem em um Endpoint essa requisição HTTP,
contendo um JSON com todos os dados da compra. Cada sistema decide o que fazer com as informações
recebidas, de acordo com a necessidade. Por exemplo, o sistema de liberação dos e-books verifica
se a compra possuía e-books e gera os links de download para o comprador, enquanto que o sistema
de logística já dá baixa no estoque quando a compra é de um impresso, além de notificar as pessoas
quando algum livro está ficando com estoque crítico. Essa característica importante para o maior
desacoplamento dos serviços é conhecida como Smart endpoints, dumb pipes, que em uma tradução
livre pode ser entendida como Endpoints inteligentes e fluxos
simples. \cite{arquitetura-de-microservicos-ou-monolitica}.

\end{citacao}


O termo que se usa para identificar esse modelo de arquitetura adequa-se bem a proposta.
Como expressado por (Sam Newman,2015), “Micro-serviços são pequenos serviços autônomos que trabalham em conjunto”.
Outra definição de microserviços, “Em suma, o estilo arquitetônico do microserviço é uma abordagem para desenvolver
uma única aplicação como um conjunto de pequenos serviços, cada um executando em seu próprio processo e se comunicando 
com mecanismos leves, muitas vezes uma API de recursos HTTP. Esses serviços são construídos em torno de recursos de 
negócios e implementáveis independentemente por meio de maquinaria de implantação totalmente automatizada.
Existe um mínimo de gerenciamento centralizado desses serviços, que pode ser escrito em diferentes linguagens de 
programação e usar diferentes tecnologias de armazenamento de dados. \cite{martin-fowler-microservices}.


Com o aumento exponencial na quantidade de aplicações que são desenvolvidas, atrelado a isso tem-se as milhares de base 
de código existentes. Essas bases aumentam tanto de tamanho como de complexidade. Essas características dificultam a 
equipe de desenvolvimento, entendendo que a medida que o código cresce, torna-se difícil reparar ou realizar mudanças. 
Esse cenário torna-se mais desafiador quando fala-se de um sistema monolítico. Outra questão que pode-se apontar 
nos aplicativos monolíticos, é que estes apesar de funcionarem de forma satisfatória, estão frustrando algumas pessoas.
Isso porque à medida que as alterações precisam ser aplicadas é necessária toda a reconstrução do monolítico. Com passar 
de algumas mudanças, a dificuldade em manter uma boa estrutura modular torna-se cada vez maior. Manter as alterações 
que  afetariam um módulo que esta dentro de outro módulo, exige o escalonamento, este requer o redimensionamento de todo 
o aplicativo e não as partes especificas. Essas implicações criaram a necessidade de um modelo que solucionasse problemas 
que impactavam o avanço mais dinâmico do desenvolvimento da aplicação.
Microserviços conseguem abordar os temas mencionados garantindo a entrega do projeto, usando-se de um código mais coeso 
e interconectado.  Pode-se enxergar diferenças, quando compararmos a algumas bibliotecas de sistema.


Nos microserviços a independência de sua implantação é algo tido como uma das razões para utilizá-los ao invés das
bibliotecas. Estas são atreladas a um único processo, mesmo contendo várias bibliotecas, todas estarão atreladas ao mesmo
processo, uma vez que se faz alterações em qualquer delas, resulta em uma implantação do aplicativo inteiro. Caso diferente
ocorre quando se implementa microserviços. O aplicativo é decomposto em vários serviços, assim se espera que cada mudança
implique apenas uma redistribuição do serviço alterado. O exemplo demonstrado não se aplica em todos os casos. Algumas 
vezes mudanças que foram feitas, condenam outros serviços ou corrompem o resultado esperado. Contudo o objetivo da
arquitetura de microserviços é tentar atingir o mínimo possível áreas de código que não deveriam ser afetadas.


Em micrserviços o ideal é que contenha uma ou duas responsabilidades, casos que sua função esteja interligada em muitas tarefas se torna algo distante do proposto em seu conceito principal.
A arquitetura permite que a manutenção corretiva seja ágil, na construção de suas partes principais e quando alcançando sua fase final. Esta correção será feita de modo a não impactar diretamente a outro trecho de código ou serviço. Outra vantagem são os testes e a implementação que são tratados de uma maneira dinâmica e assertiva. Microserviços possibilitam a atuação de uma equipe que não necessita de grande número de integrantes. Essa metodologia age de forma a integrar todos com objetivos distribuídos e próximos. Uma equipe enxuta, em muitas situações consegue identificar erros e corrigi-los antes que avancem e o problema seja descoberto mais adiante.


Em projetos separam-se a aplicação em partes, estas são distribuídas por competências específicas. Equipes concentram-se 
em servidores ou banco de dados. Essa separação pode causar problemas de comunicação ou orçamentários caso alguma aprovação
seja necessária. O modelo de microserviços, em um contexto geral, equipes são multifuncionais, todos atuam ou conhecem as
áreas para o desenvolvimento, experiência do usuário, banco de dados e gerenciamento de projetos.


O ciclo de desenvolvimento em que um modelo de projeto é submetido, pode ser separado em construção, entrega e manutenção.
Esta última é uma organização que não está ligada a equipe construtora. Os integrantes que fizeram parte da primeira e
segunda parte são dissolvidos e alocados em outros lugares. Métodos que tendem a utiliza-se dessa metodologia são evitados
quando fala-se em microserviços, isso porque prefere-se a noção de possuir um produto ao longo da sua vida útil completa.
Dessa maneira transfere-se a responsabilidade de manter o software em produção para equipe de desenvolvimento, esse
comportamento traz proximidade dos criadores e utilizadores da aplicação, aperfeiçoamentos, suporte e contato direto, são
evidenciados diariamente nesse modelo.
